{% extends 'base.html.twig' %}

{% block title %}Annonce - Plant et Flower{% endblock %}

{% block js %}
    <script defer src={{ asset('assets/Javascript/annonce.js') }}></script>
{% endblock js %}

{% block body %}

    <div class="container-return">
        <a class="return" href={{ path('home_annonces') }}>Retour</a>
    </div>
    <div class="fullAnnonce">
        <div class="corpsAnnonce">
            {% for image in annonce.images.slice(0,1) %}
                <div class="imagePrincipale">
                    <img id="imagePrincipale_self" src="{{ asset('/uploads/' ~ image.name) }}" alt="Grand"/>
                </div>
            {% endfor %}

            <div class="columnImage">
                <img class="mini-image"
                     src="{{ asset('/uploads/' ~ annonce.images[0].name) }}"
                     alt="miniature"/>
                {% if annonce.images|length > 1 %}
                    <img class="mini-image"
                         src="{{ asset('/uploads/' ~ annonce.images[1].name) }}"
                         alt="miniature"/>
                {% endif %}
                {% if annonce.images|length > 2 %}
                    <img class="mini-image"
                         src="{{ asset('/uploads/' ~ annonce.images[2].name) }}"
                         alt="miniature"/>
                {% endif %}
            </div>

            <div class="ficheAnnonce">
                <div class="dateExpAnnonce">
                    <p>Date d'expiration : {{ annonce.dateExpiration | date('d/m/Y') }}</p>
                </div>
                <div class="headTitle">
                    <h1 class="plant">{{ annonce.title }}</h1>
                </div>
                <div class='titre-description'>
                    <h2>Description</h2>
                    <div class="annonceCategory">
                        <p id="annonceCategory">{{ annonce.category.content }}</p>
                    </div>
                    <div class="annonceDescription">
                        <p>{{ annonce.description }}</p>
                    </div>
                </div>
                <div class="headInfo">
                    <div>
                        <h2>{{ annonce.ville }}</h2>
                    </div>
                    <div class="delivery_mod">
                        <div class="delivery_mod_choice">
                            {% if annonce.handDelivery %}
                                <div class="deliveryBackground">
                                    <p>Remise en main propre</p>
                                </div>
                            {% endif %}
                            {% if annonce.shipement %}
                                <div class="deliveryBackground">
                                    <p>Livraison possible</p>
                                </div>
                            {% endif %}
                            <div class="potPlant">
                                Pot disponible :
                                {% if annonce.plantPot %}
                                    oui
                                {% else %}
                                    non
                                {% endif %}
                            </div>
                        </div>
                        <div>
                            <h1 class='priceTotal'>{{ annonce.priceTotal }}€</h1>
                            <div class="container-all_btn_sold_editor">
                                {% if annonce.sold and app.user.email != annonce.acheteur %}
                                    <div class="container-btn_sold_editor">
                                        <a class="btn-sold_editor" disabled>Déjà vendu</a>
                                    </div>
                                {% elseif annonce.sold == true
                                    and app.user.email == annonce.acheteur
                                    and annonce.confirm == false %}
                                    <div class="container-btn_sold_editor">
                                        <a class="btn-sold_editor"
                                           href={{ path('paiement_confirmation', {'id': annonce.id}) }}>
                                            Confirmer la réception
                                        </a>
                                    </div>
                                {% elseif app.user
                                    and app.user.id == annonce.user.id
                                    and annonce.sold == false
                                    and annonce.confirm == false %}
                                    <div class="container-btn_sold_editor">
                                        <a class="btn-sold_editor"
                                           href={{ path('annonce_editer', {'annonceId': annonce.id}) }}>
                                            Modifié l'annonce
                                        </a>
                                    </div>
                                    <div class="container-btn_sold_editor">
                                        <a id="annonce-delete_btn" class="btn-sold_editor">Retirer l'annonce</a>
                                    </div>
                                {% elseif not app.user %}
                                    <div class="container-btn_sold_editor">
                                        <a class="btn-sold_editor" href={{ path('registration_register') }}>
                                            Acheter
                                        </a>
                                    </div>
                                {% else %}
                                    <div class="container-btn_sold_editor">
                                        <a class="btn-sold_editor"
                                           href={{ path('annonce_modeDeRemise', {'id': annonce.id}) }}>
                                            Acheter
                                        </a>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        <div id="annonce-confirm_delete">
                            <p>Êtes-vous sûr de vouloir supprimer l'annonce ?</p>
                            <div class="container-confirm_answer">
                                <a class="answer-delete_yes"
                                   href="{{ path('annonce_supprimer', {'annonceId': annonce.id}) }}">Oui</a>
                                <a class="answer-delete_no" id="annonce-answer-delete_no">Non</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="description">
                    <img src="{{ asset('media/img/profil.png') }}" alt="Photo de profil default" class="pdpAnnonce">
                    <div class="infoVendeur">
                        <p>Vendu par : {{ annonce.user.firstName }}</p>
                        <a href="{{ path('annonce_voirprofil',{'id': annonce.user.id}) }}">Consulter les annonces de
                            {{ annonce.user.firstName }}.</a>
                    </div>
                </div>

                <div class="textInfo">
                    <p>Les informations du vendeur seront données seulement après l’achat du produit.</p>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
